/*=================================================================================================
 * @name: popelt
 * @type: jQuery
 * @author: (c) Elton Jain - @eltonjain
 * @demo: http://welbour.com/labs/popelt
 * @version: 1.0
 * @requires jQuery 1.9.1
 *=================================================================================================*/
(function(e){function t(t){function w(){return i.innerHeight||s.height()}function E(){return i.innerWidth||s.width()}function S(){var t="."+h+"."+m,r="."+c+"."+m;e(t).on("click","."+l,n.close);if(b.closeClass){b.closeClass=b.closeClass.replace(".","");e(t).on("click","."+b.closeClass,n.close)}if(b.closeButton===true){e(t).on("click","."+f,n.close)}if(b.modal===true){e("body").on("click",r+", "+t,n.close);e("body").on("click",t+" .pop-block",function(e){e.stopPropagation()})}if(b.escClose!==false){T()}s.on("resize",L)}function x(t){var n="."+h+"."+t,i="."+c+"."+t;e(i+", "+n).off("click");e(n+"."+l).off("click");if(b.closeClass){e(n+"."+b.closeClass.replace(".","")).off("click")}r.off("keydown."+t)}function T(){r.on("keydown."+m,function(e){if(e.which==27){e.stopImmediatePropagation();n.close(i.popup_current_id);return false}})}function N(t){var r="."+h+"."+m+" ."+p;n.setContent(t);e(r).append(t);k();L()}function C(){if(b.contentType=="ajax"&&b.loadUrl){e.get(b.loadUrl,function(t){var n=e('<div class="pop-ajax-wrapper"></div>').append(t);N(n);return false})}else if(b.contentType=="iframe"&&b.loadUrl){var t=e('<iframe class="pop-iframe"></iframe>');t.attr("src",b.loadUrl);t.css({border:0,width:b.iframeWidth,height:b.iframeHeight});N(t)}else if(b.contentType.indexOf("#")==0){var n=e(b.contentType);N(n)}}function k(){var t="."+h+" "+"."+p;if(b.focus===true){e(t).find("input,textarea").first().focus()}}function L(){if(b.offsetTop!==""&&b.offsetTop>=0||b.valign===false){return false}var t="."+h+"."+m+" .pop-block",n=e(t).outerWidth(),r=e(t).outerHeight();_new_top=(o-r)/2-20;_new_top=_new_top>0?_new_top:0;e("."+h+"."+m+" .pop-container").css("margin-top",_new_top)}var n=this;var r=e(document),i=window,s=e(i),o=w(),u=E(),a="__pop",f="pop-btn-close",l="pop-close",c="pop-screen",h="pop-wrap",p="pop-content",d="pop-action-block",v="pop-title",m,g=9e3;if(!e.isArray(i._popups_open))i._popups_open=[];var y={modal:true,title:false,content:"",offsetTop:-1,closeButton:true,closeBtnTooltip:"Close",width:600,closeClass:"",escClose:true,focus:null,contentType:false,loadUrl:false,buttons:[],fadeSpeed:200,iframeHeight:"300px",iframeWidth:"100%",maxHeight:false,valign:true,responsive:false,overlayColor:false,overlayOpacity:false};var b=e.extend(y,t);n.init=function(){i._popups=(i._popups||0)+1;m=a+i._popups+"__";g+=i._popups};n.setContent=function(e){b.content=e;return n};n.showPopup=function(){if(e("."+h+"."+m).length<=0){var t,r,s,o,u;o=e("<div>").addClass(c).addClass(m).css("z-index",g);if(b.overlayColor){o.css("background",b.overlayColor)}if(b.overlayOpacity){o.css("opacity",b.overlayOpacity).css("filter","alpha("+b.overlayOpacity*10+")")}s=e("<div>").addClass(p);if(b.title){r=e("<div>").addClass(v).text(b.title)}if(b.content){s.append(b.content).appendTo(s)}if(b.buttons.length){u=e("<div>").addClass(d);e.each(b.buttons,function(t,n){var r=n.classname,i=n.clickEvent;if(e.isFunction(r)){i=r;r=""}var s=e("<button>").addClass("btn").addClass(n.classname).text(n.label);if(n.clickEvent){s.on("click",n.clickEvent)}u.append(s)})}if(b.maxHeight){s.css("max-height",b.maxHeight)}popBlock=e("<div>").addClass("pop-block");if(b.closeButton!==false){var a=e("<span>").addClass("pop-btn-close").html("Ã—");if(b.closeBtnTooltip){a.attr("title",b.closeBtnTooltip)}popBlock.append(a)}popBlock.append(r).append(s).append(u);popContainer=e("<div>").addClass("pop-container").width(b.width).append(popBlock);popContainer.css("margin","0 auto");if(b.offsetTop>=0){popContainer.css("margin-top",b.offsetTop)}if(b.responsive===true){popContainer.css("max-width","100%")}t=e("<div>").addClass(h).addClass(m).css("z-index",g+1).append(popContainer);e("body").append(o);e("body").append(t)}if(b.contentType||b.loadUrl){C()}e("."+c+"."+m).show();e("."+h+"."+m).show();S();L();i._popups_open_count++;i._popups_open.push(m);i.popup_current_id=m;if(e("body").not(".noscroll")){e("body").addClass("noscroll")}return n};n.addButton=function(t,r,i){var s={label:t};if(e.isFunction(r)){i=r;r=""}s.classname=r;if(e.isFunction(i)){s.clickEvent=i}else{s.clickEvent=n.close}b.buttons.push(s);return s};n.addOKButton=function(e){n.addButton("OK",e)};n.addCancelButton=function(){n.addButton("Cancel",n.close)};n.addCloseButton=function(){n.addButton("Close",n.close)};n.closePopup=function(t){popupId=i.popup_current_id?i.popup_current_id:m;x(popupId);var n=e("."+h+"."+popupId),r=e("."+c+"."+popupId);n.fadeTo(b.fadeSpeed,0,function(){e(this).remove()});r.fadeTo(b.fadeSpeed,0,function(){e(this).remove()});--i._popups_open_count;i._popups_open.pop();i.popup_current_id=i._popups_open[i._popups_open.length-1];if(i._popups_open_count==0)e("body").removeClass("noscroll");return false};n.show=n.showPopup;n.close=n.closePopup;n.init();return this}window.popelt=t})(jQuery)